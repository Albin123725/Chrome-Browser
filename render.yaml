services:
  - type: web
    name: chrome-persistent
    env: docker
    plan: free
    dockerfilePath: ./Dockerfile
    port: 80
    
    envVars:
      # Keep Chrome running settings
      - key: CHROME_FLAGS
        value: "--no-sandbox --disable-dev-shm-usage --disable-gpu --remote-debugging-port=9222 --window-size=1280,720 --start-maximized --user-data-dir=/data/chrome --no-first-run --no-default-browser-check --disable-background-timer-throttling --disable-renderer-backgrounding --disable-backgrounding-occluded-windows --disable-ipc-flooding-protection"
      
      - key: STARTUP_URL
        value: "https://colab.research.google.com/drive/1jckV8xUJSmLhhol6wZwVJzpybsimiRw1?usp=sharing"
      
      - key: KEEP_ALIVE_INTERVAL
        value: "300"  # Check every 5 minutes
    
    # Auto-restart if crashes
    healthCheckPath: /health
    healthCheckTimeout: 30
    autoDeploy: true
